/*! asIconPicker - v0.1.0 - 2014-05-04
* https://github.com/amazingsurge/jquery-asIconPicker
* Copyright (c) 2014 amazingSurge; Licensed MIT */
(function(e,i,s,t){"use strict";var n="asIconPicker",a={namespace:"asIconPicker",source:!1,tooltip:!0,iconPicker:function(){return'<div class="namespace-selector"><span class="namespace-selected-icon"><i class="fa fa-ban"></i>None selected</span><span class="namespace-selector-button"><i class="fa fa-caret-down"></i></span></div><div class="namespace-selector-popup"><div class="namespace-selector-search"><input type="text" name="" value="" placeholder="Search" class="icons-search-input"/><i class="fa fa-search"></i></div><div class="namespace-icons-container"></div></div>'},onInit:null,onReady:null,onAfterFill:null},o=e[n]=function(i,s){this.element=i,this.$element=e(i),this.options=e.extend({},a,s,this.$element.data()),this._plugin=n,this.namespace=this.options.namespace,this.classes={disabled:this.namespace+"_disabled",wrapper:this.namespace+"-wrapper",mask:this.namespace+"-mask"},this.$element.addClass(this.namespace),this.$element.wrap('<div class="'+this.classes.wrapper+'"></div>');var t=this.options.iconPicker().replace(/namespace/g,this.namespace);this.$iconPicker=e(t),this.$searchIcon=this.$iconPicker.find("."+this.namespace+"-selector-search i"),this.$iconContainer=this.$iconPicker.find("."+this.namespace+"-icons-container"),this.iconsSearched=[],this.isSearch=!1,this.currentIcon=!1,this.open=!1,this.disabled=!1,this.initialized=!1,this._trigger("init"),this.init()};o.prototype={constructor:o,init:function(){var i=this;this.$element.hide(),this.$element.before(this.$iconPicker),!this.options.source&&this.$element.is("select")&&(this.options.source=[],this.$element.children().each(e.proxy(function(s,t){if("optgroup"===t.tagName.toLowerCase()){var n=e.extend({},e(t).data(),{group:!0,label:t.label,options:[]});e(t).children().each(function(){n.options.push(e(this).val())}),i.options.source.push(n)}else e(t).val()&&this.options.source.push(e(t).val())},this))),this.loadIcon(),this.$iconContainer.parent().hide(),this.$iconPicker.parent().find("."+this.namespace+"-selector").click(e.proxy(function(){this.toggleIconSelector()},this)),this.$iconPicker.find(".icons-search-input").keyup(e.proxy(function(i){var s=e(i.currentTarget).val();if(""===s)return this.resetSearch(),t;this.$searchIcon.removeClass("fa-search"),this.$searchIcon.addClass("fa-times"),this.isSearch=!0,this.iconsSearched=[];for(var n,a=0;n=this.options.source[a];a++)if(n.group){var o=[];o.group=!0,o.label=n.label,o.options=e.grep(n.options,function(e){return e.search(s.toLowerCase())>=0}),o.options.length>0&&this.iconsSearched.push(o)}else n.search(s.toLowerCase())>=0?this.iconsSearched.push(n):0;this.fillIconContainer()},this)),this.$iconContainer.on("click",".fa-box",e.proxy(function(i){this.setSelectedIcon(e(i.currentTarget).find("i").attr("class")),this.toggleIconSelector()},this)),this.$iconPicker.click(function(e){return e.stopPropagation(),!1}),this.initialized=!0,this._trigger("ready")},loadIcon:function(){this.$iconContainer.html('<i class="fa fa-spinner animate-spin loading"></i>'),this.options.source instanceof Array&&this.fillIconContainer()},fillIconContainer:function(){this.$iconContainer.data("scroll")!==t&&this.$iconContainer.scrollable("destory");var i=[],s=[];if(i=this.isSearch?this.iconsSearched:this.options.source,1>i.length)return this.$iconContainer.html('<span class="icons-picker-error"><i class="fa fa-ban"></i></span>'),t;this.$iconContainer.html("");for(var n,a=0;n=i[a];a++)if(n.group){if(n.options.length)var o=e('<div class="'+this.namespace+'-group"><p>'+n.label+":</p></div>").appendTo(this.$iconContainer);for(var c,r=0;c=n.options[r];r++)e("<span/>",{html:'<i class="fa '+c+'"></i>',"class":"fa-box",title:this.options.tooltip?c:""}).appendTo(o),s.push(c)}else e("<span/>",{html:'<i class="fa '+n+'"></i>',"class":"fa-box",title:this.options.tooltip?n:""}).appendTo(this.$iconContainer),s.push(n);this.options.tooltip&&(e.asTooltip.closeAll(),this.$iconContainer.find(".fa-box").asTooltip({namespace:"asTooltip",skin:"skin-dream",onlyOne:!0})),-1===e.inArray(this.$element.val(),s)?this.setSelectedIcon():this.setSelectedIcon("fa "+this.$element.val()),this.$iconContainer.scrollable(),this._trigger("afterFill")},setHighlightedIcon:function(){this.$iconContainer.find(".current-icon").removeClass("current-icon"),this.currentIcon&&this.$iconContainer.find("."+this.currentIcon).parent("span").addClass("current-icon")},setSelectedIcon:function(e){var i="";e&&(i=e.match(/fa-+\S*/g)),this.$iconPicker.find("."+this.namespace+"-selected-icon").html('<i class="'+(e||"fa fa-ban "+this.namespace+"-none-selected")+'"></i>'+(i||"None selected")),this.$element.val(e).triggerHandler("change"),this.currentIcon=i,this.setHighlightedIcon()},toggleIconSelector:function(){var i=this;this.open=this.open?0:1,this.$iconPicker.parent().find("."+this.namespace+"-selector-popup").slideToggle(300),this.$iconPicker.find("."+this.namespace+"-selector-button i").toggleClass("fa-caret-up"),this.$iconPicker.find("."+this.namespace+"-selector-button i").toggleClass("fa-caret-down"),this._clearMask(),this.open&&(this.$iconPicker.find(".icons-search-input").focus().select(),this.$mask=e("<div></div>").addClass(this.classes.mask).appendTo(this.$element.parent()),this.$mask.on("click",function(){return i.toggleIconSelector(),!1}))},resetSearch:function(){this.$iconPicker.find(".icons-search-input").val(""),this.$searchIcon.removeClass("fa-times"),this.$searchIcon.addClass("fa-search"),this.isSearch=!1,this.fillIconContainer(),this.$iconContainer.outerHeight()>=290&&this.$iconContainer.scrollable()},_clearMask:function(){this.$mask&&(this.$mask.off(".asIconPicker"),this.$mask.remove(),this.$mask=null)},_trigger:function(e){this.$element.trigger(n+"::"+e,this),e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});var i="on"+e,s=arguments.length>1?Array.prototype.slice.call(arguments,1):t;"function"==typeof this.options[i]&&this.options[i].apply(this,s)},enable:function(){this.disabled=!1,this.$element.removeClass(this.classes.disabled)},disable:function(){this.disabled=!0,this.$element.addClass(this.classes.disabled)},destory:function(){this.$element.data(n,null),this._trigger("destory")}},o.defaults=a,e.fn[n]=function(i){if("string"!=typeof i)return this.each(function(){e.data(this,n)||e.data(this,n,new o(this,i))});var s=i,a=arguments.length>1?Array.prototype.slice.call(arguments,1):t;if(/^\_/.test(s))return!1;if(!(/^(getTabs)$/.test(s)||"val"===s&&a===t))return this.each(function(){var i=e.data(this,n);i&&"function"==typeof i[s]&&i[s].apply(i,a)});var c=this.first().data(n);return c&&"function"==typeof c[s]?c[s].apply(c,a):t}})(jQuery,document,window);